<app-navbar>
  <button mat-icon-button
          (click)="drawer.toggle()">
    <mat-icon>menu</mat-icon>
  </button>

  <img fxFlexAlign="center"
       src="assets/logos/png/ori-logo-full-white.png"
       style="height: 50%; margin: 0 2.5em 0 0.5em;">

  <navbar-item *ngFor="let route of routes"
               [ngClass]="{ 'selected': router.url.includes(route.path) }"
               (click)="navigateTo(route.path)"
               [fxShow]="showLink(route)">
    {{ route.label }}
  </navbar-item>

  <div fxFlex="grow"
       fxLayout="row"
       fxLayoutAlign="end">

    <div *ngIf="auth.user$ | async as user; then authenticated else guest"></div>


    <ng-template #authenticated>
      <button mat-mini-fab
              *ngIf="user"
              [style.background]="'url('+ user.photoURL + ')'"
              [style.backgroundSize]="'cover'"
              style="margin: 0 1em;"
              [matMenuTriggerFor]="menu">
      </button>
      <mat-menu #menu="matMenu">
        <!-- <button mat-menu-item>Item 1</button> -->
        <mat-list>
          <h3 mat-subheader>Info</h3>
          <mat-list-item>
            <mat-icon mat-list-icon>account_circle</mat-icon>
            <p mat-line> {{ user.displayName }} </p>
          </mat-list-item>
          <mat-list-item>
            <mat-icon mat-list-icon>email</mat-icon>
            <p mat-line> {{ user.email }} </p>
          </mat-list-item>
          <mat-divider></mat-divider>
        </mat-list>
        <mat-action-list>
          <button mat-list-item
                  (click)="auth.signOut()"> Logout </button>
        </mat-action-list>

      </mat-menu>
    </ng-template>

    <ng-template #guest>
      <button mat-button
              (click)="auth.googleSignin()">
        <div fxLayout="row"
             fxLayoutAlign="space-around center"
             style="width: 75px">
          <mat-icon>account_circle</mat-icon>
          <span>Login</span>
        </div>
      </button>
    </ng-template>

  </div>
  <!-- <div style="width: 30px;"></div> -->

  <!-- <span> {{ (auth.user$ | async)?.displayName | json}} </span> -->
</app-navbar>

<mat-progress-bar *ngIf="(loading$ | async) > 0"
                  mode="determinate"
                  [value]="loading$ | async"
                  [bufferValue]="(loading$ | async) + ((loading$ | async) % 7 + 5)"></mat-progress-bar>

<mat-drawer-container fxFlex='grow'>
  <mat-drawer #drawer
              class="sidenav"
              mode="side">
    <!-- <app-calender></app-calender> -->
  </mat-drawer>

  <mat-drawer-content class="sidenav-content">
    <router-outlet></router-outlet>
  </mat-drawer-content>

</mat-drawer-container>
